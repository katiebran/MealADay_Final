"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
function series(list) {
  var _this = this;

  for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    args[_key - 1] = arguments[_key];
  }

  var result = list.reduce(function (prev, current) {
    if (prev.p === null) {
      prev.p = Promise.resolve(current.apply(_this, args));
      return prev;
    }

    prev.p = prev.p.then(function (r) {
      prev.results.push(r);
      return current.apply(_this, args);
    });

    return prev;
  }, {
    p: null,
    results: []
  });

  return result.p.then(function (r) {
    result.results.push(r);
    return result.results;
  });
}

function waterfall(list, init) {
  for (var _len2 = arguments.length, args = Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {
    args[_key2 - 2] = arguments[_key2];
  }

  var _this2 = this;

  return list.reduce(function (prev, current) {
    return prev.then(function (x) {
      return current.call.apply(current, [_this2, x].concat(args));
    });
  }, Promise.resolve(init));
}

exports.series = series;
exports.waterfall = waterfall;